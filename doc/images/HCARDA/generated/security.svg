<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1170px" preserveAspectRatio="none" style="width:1169px;height:1170px;" version="1.1" viewBox="0 0 1169 1170" width="1169px" zoomAndPan="magnify"><defs><filter height="300%" id="f152rugf8lj1r3" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--cluster de.gematik.ti.healthcardaccess.security--><polygon fill="#FFFFFF" filter="url(#f152rugf8lj1r3)" points="22,24,306,24,313,47.6094,1136,47.6094,1136,1158,22,1158,22,24" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="22" x2="313" y1="47.6094" y2="47.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="278" x="26" y="40.5332">de.gematik.ti.healthcardaccess.security</text><!--cluster de.gematik.ti.healthcardaccess.security.keyentities--><polygon fill="#FFFFFF" filter="url(#f152rugf8lj1r3)" points="46,68,411,68,418,91.6094,873,91.6094,873,775,46,775,46,68" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="46" x2="418" y1="91.6094" y2="91.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="359" x="50" y="84.5332">de.gematik.ti.healthcardaccess.security.keyentities</text><!--class KeyDerivationFunction--><rect fill="#FEFECE" filter="url(#f152rugf8lj1r3)" height="172.5234" id="KeyDerivationFunction" style="stroke: #A80036; stroke-width: 1.5;" width="160" x="212" y="819"/><ellipse cx="229.7" cy="835" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M231.7,831.5 Q231.9031,831 232.1375,830.75 Q232.3719,830.5 232.6375,830.5 Q233.1063,830.5 233.4031,830.7813 Q233.7,831.0625 233.7,831.7188 L233.7,833.2813 Q233.7,833.9375 233.4188,834.2188 Q233.1375,834.5 232.7,834.5 Q232.3094,834.5 232.0594,834.3281 Q231.8094,834.1563 231.7,833.7031 Q231.6531,833.3906 231.4813,833.2188 Q231.1688,832.8906 230.6063,832.7031 Q230.0438,832.5 229.4813,832.5 Q228.7781,832.5 228.1844,832.7813 Q227.6063,833.0625 227.1531,833.6875 Q226.7,834.3125 226.7,835.1719 L226.7,836.0938 Q226.7,837.125 227.5438,837.8125 Q228.3875,838.5 229.8875,838.5 Q230.7781,838.5 231.4031,838.2969 Q231.7625,838.1875 232.1688,837.8281 Q232.4344,837.625 232.575,837.5625 Q232.7156,837.5 232.8875,837.5 Q233.2156,837.5 233.45,837.7656 Q233.7,838.0156 233.7,838.375 Q233.7,838.7188 233.3563,839.125 Q232.8563,839.7188 232.0594,840.0469 Q231.0125,840.5 229.7313,840.5 Q228.2313,840.5 227.0281,839.9063 Q226.0594,839.4375 225.3719,838.4219 Q224.7,837.4063 224.7,836.2031 L224.7,835.1094 Q224.7,833.8594 225.2938,832.7656 Q225.9031,831.6719 226.95,831.0938 Q228.0125,830.5 229.2,830.5 Q229.9188,830.5 230.5438,830.75 Q231.1688,831 231.7,831.5 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="122" x="244.3" y="839.9102">KeyDerivationFunction</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="213" x2="371" y1="851" y2="851"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="220" y="860.418"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="116" x="232" y="866.4189">CHECKSUMLENGTH : int</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="220" y="874.2539"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="99" x="232" y="880.2549">AES128LENGTH : int</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="220" y="888.0898"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="99" x="232" y="894.0908">OFFSETLENGTH : int</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="220" y="901.9258"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="94" x="232" y="907.9268">ENCLASTBYTE : int</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="220" y="915.7617"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="97" x="232" y="921.7627">MACLASTBYTE : int</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="220" y="929.5977"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="134" x="232" y="935.5986">PASSWORDLASTBYTE : int</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="213" x2="371" y1="942.0156" y2="942.0156"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="220" y="951.4336"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="116" x="232" y="957.4346">KeyDerivationFunction()</text><ellipse cx="223" cy="968.2695" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="81" x="232" y="971.2705">getAES128Key()</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="220" y="979.1055"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="106" x="232" y="985.1064">replaceLastKeyByte()</text><!--class Mode--><rect fill="#FEFECE" filter="url(#f152rugf8lj1r3)" height="89.5078" id="Mode" style="stroke: #A80036; stroke-width: 1.5;" width="72" x="256" y="1052"/><ellipse cx="275.5" cy="1068" fill="#EB937F" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M274,1069 L274,1071 L278,1071 L278,1070 L278,1069.5156 L278.625,1069 L279,1069 L279.375,1069 L280,1069.5156 L280,1070 L280,1073 L272,1073 L271.5156,1073 L271,1072.375 L271,1072 L271,1071.625 L271.5156,1071 L272,1071 L272,1071 L272,1065 L272,1065 L271.5156,1065 L271,1064.375 L271,1064 L271,1063.625 L271.5156,1063 L272,1063 L280,1063 L280,1066 L280,1066.4844 L279.375,1067 L279,1067 L278.625,1067 L278,1066.4844 L278,1066 L278,1065 L274,1065 L274,1067 L275,1067 L275,1066.5156 L275,1066.5156 L275.625,1066 L276,1066 L276.375,1066 L277,1066.5156 L277,1067 L277,1069 L277,1069.4844 L276.375,1070 L276.375,1070 L276,1070 L275.625,1070 L275,1069.4844 L275,1069.4844 L275,1069 L274,1069 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="30" x="290.5" y="1072.9102">Mode</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="257" x2="327" y1="1084" y2="1084"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="262" y="1099.4189">ENC</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="23" x="262" y="1113.2549">MAC</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="60" x="262" y="1127.0908">PASSWORD</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="257" x2="327" y1="1133.5078" y2="1133.5078"/><!--class Utilities--><rect fill="#FEFECE" filter="url(#f152rugf8lj1r3)" height="103.3438" id="Utilities" style="stroke: #A80036; stroke-width: 1.5;" width="193" x="889.5" y="621"/><ellipse cx="961.25" cy="637" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M963.25,633.5 Q963.4531,633 963.6875,632.75 Q963.9219,632.5 964.1875,632.5 Q964.6563,632.5 964.9531,632.7813 Q965.25,633.0625 965.25,633.7188 L965.25,635.2813 Q965.25,635.9375 964.9688,636.2188 Q964.6875,636.5 964.25,636.5 Q963.8594,636.5 963.6094,636.3281 Q963.3594,636.1563 963.25,635.7031 Q963.2031,635.3906 963.0313,635.2188 Q962.7188,634.8906 962.1563,634.7031 Q961.5938,634.5 961.0313,634.5 Q960.3281,634.5 959.7344,634.7813 Q959.1563,635.0625 958.7031,635.6875 Q958.25,636.3125 958.25,637.1719 L958.25,638.0938 Q958.25,639.125 959.0938,639.8125 Q959.9375,640.5 961.4375,640.5 Q962.3281,640.5 962.9531,640.2969 Q963.3125,640.1875 963.7188,639.8281 Q963.9844,639.625 964.125,639.5625 Q964.2656,639.5 964.4375,639.5 Q964.7656,639.5 965,639.7656 Q965.25,640.0156 965.25,640.375 Q965.25,640.7188 964.9063,641.125 Q964.4063,641.7188 963.6094,642.0469 Q962.5625,642.5 961.2813,642.5 Q959.7813,642.5 958.5781,641.9063 Q957.6094,641.4375 956.9219,640.4219 Q956.25,639.4063 956.25,638.2031 L956.25,637.1094 Q956.25,635.8594 956.8438,634.7656 Q957.4531,633.6719 958.5,633.0938 Q959.5625,632.5 960.75,632.5 Q961.4688,632.5 962.0938,632.75 Q962.7188,633 963.25,633.5 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="41" x="981.75" y="641.9102">Utilities</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="890.5" x2="1081.5" y1="653" y2="653"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="897.5" y="662.418"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="167" x="909.5" y="668.4189">UNCOMPRESSEDPOINTVALUE : int</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="890.5" x2="1081.5" y1="674.8359" y2="674.8359"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="897.5" y="684.2539"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="41" x="909.5" y="690.2549">Utilities()</text><ellipse cx="900.5" cy="701.0898" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="105" x="909.5" y="704.0908">byteArrayToECPoint()</text><ellipse cx="900.5" cy="714.9258" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="115" x="909.5" y="717.9268">getKeyObjectEncoded()</text><!--class MacPcd--><rect fill="#FEFECE" filter="url(#f152rugf8lj1r3)" height="421.5703" id="MacPcd" style="stroke: #A80036; stroke-width: 1.5;" width="163" x="62.5" y="104"/><ellipse cx="118.25" cy="120" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M120.25,116.5 Q120.4531,116 120.6875,115.75 Q120.9219,115.5 121.1875,115.5 Q121.6563,115.5 121.9531,115.7813 Q122.25,116.0625 122.25,116.7188 L122.25,118.2813 Q122.25,118.9375 121.9688,119.2188 Q121.6875,119.5 121.25,119.5 Q120.8594,119.5 120.6094,119.3281 Q120.3594,119.1563 120.25,118.7031 Q120.2031,118.3906 120.0313,118.2188 Q119.7188,117.8906 119.1563,117.7031 Q118.5938,117.5 118.0313,117.5 Q117.3281,117.5 116.7344,117.7813 Q116.1563,118.0625 115.7031,118.6875 Q115.25,119.3125 115.25,120.1719 L115.25,121.0938 Q115.25,122.125 116.0938,122.8125 Q116.9375,123.5 118.4375,123.5 Q119.3281,123.5 119.9531,123.2969 Q120.3125,123.1875 120.7188,122.8281 Q120.9844,122.625 121.125,122.5625 Q121.2656,122.5 121.4375,122.5 Q121.7656,122.5 122,122.7656 Q122.25,123.0156 122.25,123.375 Q122.25,123.7188 121.9063,124.125 Q121.4063,124.7188 120.6094,125.0469 Q119.5625,125.5 118.2813,125.5 Q116.7813,125.5 115.5781,124.9063 Q114.6094,124.4375 113.9219,123.4219 Q113.25,122.4063 113.25,121.2031 L113.25,120.1094 Q113.25,118.8594 113.8438,117.7656 Q114.4531,116.6719 115.5,116.0938 Q116.5625,115.5 117.75,115.5 Q118.4688,115.5 119.0938,115.75 Q119.7188,116 120.25,116.5 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="43" x="138.75" y="124.9102">MacPcd</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="63.5" x2="224.5" y1="136" y2="136"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70.5" y="145.418"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="65" x="82.5" y="151.4189">LOG : Logger</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70.5" y="159.2539"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="43" x="82.5" y="165.2549">MAX : int</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70.5" y="173.0898"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="54" x="82.5" y="179.0908">TAG_6 : int</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70.5" y="186.9258"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="60" x="82.5" y="192.9268">TAG_49 : int</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70.5" y="200.7617"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="74" x="82.5" y="206.7627">macPcd : byte[]</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70.5" y="214.5977"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="137" x="82.5" y="220.5986">sharedSecretKBytes : byte[]</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70.5" y="228.4336"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="100" x="82.5" y="234.4346">keyP : KeyParameter</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70.5" y="242.2695"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="49" x="82.5" y="248.2705">mac : Mac</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70.5" y="256.1055"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="94" x="82.5" y="262.1064">authTokenY : byte[]</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70.5" y="269.9414"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="93" x="82.5" y="275.9424">authTokenX : byte[]</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70.5" y="283.7773"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="59" x="82.5" y="289.7783">kEnc : byte[]</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70.5" y="297.6133"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="61" x="82.5" y="303.6143">kMac : byte[]</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70.5" y="311.4492"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="85" x="82.5" y="317.4502">protocolID : String</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70.5" y="325.2852"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="79" x="82.5" y="331.2861">curve : ECCurve</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70.5" y="339.1211"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="73" x="82.5" y="345.1221">pk2Picc : byte[]</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70.5" y="352.957"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="100" x="82.5" y="358.958">pcdSkX2 : BigInteger</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70.5" y="366.793"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="82" x="82.5" y="372.7939">macPicc2 : byte[]</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70.5" y="380.6289"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="73" x="82.5" y="386.6299">pk1Picc : byte[]</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="63.5" x2="224.5" y1="393.0469" y2="393.0469"/><ellipse cx="73.5" cy="405.4648" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="46" x="82.5" y="408.4658">MacPcd()</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70.5" y="416.3008"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="115" x="82.5" y="422.3018">generateMacPcdPicc2()</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70.5" y="430.1367"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="103" x="82.5" y="436.1377">generateAuthToken()</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70.5" y="443.9727"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="125" x="82.5" y="449.9736">generateSharedSecretK()</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70.5" y="457.8086"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="117" x="82.5" y="463.8096">createAsn1AuthToken()</text><ellipse cx="73.5" cy="474.6445" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="61" x="82.5" y="477.6455">getMacPcd()</text><ellipse cx="73.5" cy="488.4805" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="48" x="82.5" y="491.4814">getKEnc()</text><ellipse cx="73.5" cy="502.3164" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="69" x="82.5" y="505.3174">getMacPicc2()</text><ellipse cx="73.5" cy="516.1523" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="50" x="82.5" y="519.1533">getKMac()</text><!--class NonceZ--><rect fill="#FEFECE" filter="url(#f152rugf8lj1r3)" height="103.3438" id="NonceZ" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="528.5" y="263.5"/><ellipse cx="554.3" cy="279.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M556.3,276 Q556.5031,275.5 556.7375,275.25 Q556.9719,275 557.2375,275 Q557.7063,275 558.0031,275.2813 Q558.3,275.5625 558.3,276.2188 L558.3,277.7813 Q558.3,278.4375 558.0188,278.7188 Q557.7375,279 557.3,279 Q556.9094,279 556.6594,278.8281 Q556.4094,278.6563 556.3,278.2031 Q556.2531,277.8906 556.0813,277.7188 Q555.7688,277.3906 555.2063,277.2031 Q554.6438,277 554.0813,277 Q553.3781,277 552.7844,277.2813 Q552.2063,277.5625 551.7531,278.1875 Q551.3,278.8125 551.3,279.6719 L551.3,280.5938 Q551.3,281.625 552.1438,282.3125 Q552.9875,283 554.4875,283 Q555.3781,283 556.0031,282.7969 Q556.3625,282.6875 556.7688,282.3281 Q557.0344,282.125 557.175,282.0625 Q557.3156,282 557.4875,282 Q557.8156,282 558.05,282.2656 Q558.3,282.5156 558.3,282.875 Q558.3,283.2188 557.9563,283.625 Q557.4563,284.2188 556.6594,284.5469 Q555.6125,285 554.3313,285 Q552.8313,285 551.6281,284.4063 Q550.6594,283.9375 549.9719,282.9219 Q549.3,281.9063 549.3,280.7031 L549.3,279.6094 Q549.3,278.3594 549.8938,277.2656 Q550.5031,276.1719 551.55,275.5938 Q552.6125,275 553.8,275 Q554.5188,275 555.1438,275.25 Q555.7688,275.5 556.3,276 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="43" x="570.7" y="284.4102">NonceZ</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="529.5" x2="626.5" y1="295.5" y2="295.5"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="536.5" y="304.918"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="65" x="548.5" y="310.9189">LOG : Logger</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="536.5" y="318.7539"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="73" x="548.5" y="324.7549">nonceZ : byte[]</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="529.5" x2="626.5" y1="331.1719" y2="331.1719"/><ellipse cx="539.5" cy="343.5898" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="46" x="548.5" y="346.5908">NonceZ()</text><ellipse cx="539.5" cy="357.4258" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="61" x="548.5" y="360.4268">getNonceZ()</text><!--class Pk1Pcd--><rect fill="#FEFECE" filter="url(#f152rugf8lj1r3)" height="241.7031" id="Pk1Pcd" style="stroke: #A80036; stroke-width: 1.5;" width="194" x="663" y="194"/><ellipse cx="734.75" cy="210" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M736.75,206.5 Q736.9531,206 737.1875,205.75 Q737.4219,205.5 737.6875,205.5 Q738.1563,205.5 738.4531,205.7813 Q738.75,206.0625 738.75,206.7188 L738.75,208.2813 Q738.75,208.9375 738.4688,209.2188 Q738.1875,209.5 737.75,209.5 Q737.3594,209.5 737.1094,209.3281 Q736.8594,209.1563 736.75,208.7031 Q736.7031,208.3906 736.5313,208.2188 Q736.2188,207.8906 735.6563,207.7031 Q735.0938,207.5 734.5313,207.5 Q733.8281,207.5 733.2344,207.7813 Q732.6563,208.0625 732.2031,208.6875 Q731.75,209.3125 731.75,210.1719 L731.75,211.0938 Q731.75,212.125 732.5938,212.8125 Q733.4375,213.5 734.9375,213.5 Q735.8281,213.5 736.4531,213.2969 Q736.8125,213.1875 737.2188,212.8281 Q737.4844,212.625 737.625,212.5625 Q737.7656,212.5 737.9375,212.5 Q738.2656,212.5 738.5,212.7656 Q738.75,213.0156 738.75,213.375 Q738.75,213.7188 738.4063,214.125 Q737.9063,214.7188 737.1094,215.0469 Q736.0625,215.5 734.7813,215.5 Q733.2813,215.5 732.0781,214.9063 Q731.1094,214.4375 730.4219,213.4219 Q729.75,212.4063 729.75,211.2031 L729.75,210.1094 Q729.75,208.8594 730.3438,207.7656 Q730.9531,206.6719 732,206.0938 Q733.0625,205.5 734.25,205.5 Q734.9688,205.5 735.5938,205.75 Q736.2188,206 736.75,206.5 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="42" x="755.25" y="214.9102">Pk1Pcd</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="664" x2="856" y1="226" y2="226"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="671" y="235.418"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="110" x="683" y="241.4189">AES_BLOCK_SIZE : int</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="671" y="249.2539"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="93" x="683" y="255.2549">BYTE_LENGTH : int</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="671" y="263.0898"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="105" x="683" y="269.0908">nonceSInt : BigInteger</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="671" y="276.9258"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="49" x="683" y="282.9268">curve : Fp</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="671" y="290.7617"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="88" x="683" y="296.7627">ecPointG : ECPoint</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="671" y="304.5977"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="168" x="683" y="310.5986">randomGenerator : SecureRandom</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="671" y="318.4336"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="100" x="683" y="324.4346">pcdSkX1 : BigInteger</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="664" x2="856" y1="330.8516" y2="330.8516"/><ellipse cx="674" cy="343.2695" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="43" x="683" y="346.2705">Pk1Pcd()</text><ellipse cx="674" cy="357.1055" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="58" x="683" y="360.1064">getPk1Pcd()</text><polygon fill="#4177AF" points="674,366.9414,670,372.9414,678,372.9414" style="stroke: #1963A0; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="72" x="683" y="373.9424">getNonceSInt()</text><polygon fill="#4177AF" points="674,380.7773,670,386.7773,678,386.7773" style="stroke: #1963A0; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="52" x="683" y="387.7783">getCurve()</text><polygon fill="#4177AF" points="674,394.6133,670,400.6133,678,400.6133" style="stroke: #1963A0; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="66" x="683" y="401.6143">getEcPointG()</text><polygon fill="#4177AF" points="674,408.4492,670,414.4492,678,414.4492" style="stroke: #1963A0; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="66" x="683" y="415.4502">getPcdSkX1()</text><polygon fill="#4177AF" points="674,422.2852,670,428.2852,678,428.2852" style="stroke: #1963A0; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="111" x="683" y="429.2861">getRandomGenerator()</text><!--class Pk1Picc--><rect fill="#FEFECE" filter="url(#f152rugf8lj1r3)" height="103.3438" id="Pk1Picc" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="394.5" y="263.5"/><ellipse cx="419.85" cy="279.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M421.85,276 Q422.0531,275.5 422.2875,275.25 Q422.5219,275 422.7875,275 Q423.2563,275 423.5531,275.2813 Q423.85,275.5625 423.85,276.2188 L423.85,277.7813 Q423.85,278.4375 423.5688,278.7188 Q423.2875,279 422.85,279 Q422.4594,279 422.2094,278.8281 Q421.9594,278.6563 421.85,278.2031 Q421.8031,277.8906 421.6313,277.7188 Q421.3188,277.3906 420.7563,277.2031 Q420.1938,277 419.6313,277 Q418.9281,277 418.3344,277.2813 Q417.7563,277.5625 417.3031,278.1875 Q416.85,278.8125 416.85,279.6719 L416.85,280.5938 Q416.85,281.625 417.6938,282.3125 Q418.5375,283 420.0375,283 Q420.9281,283 421.5531,282.7969 Q421.9125,282.6875 422.3188,282.3281 Q422.5844,282.125 422.725,282.0625 Q422.8656,282 423.0375,282 Q423.3656,282 423.6,282.2656 Q423.85,282.5156 423.85,282.875 Q423.85,283.2188 423.5063,283.625 Q423.0063,284.2188 422.2094,284.5469 Q421.1625,285 419.8813,285 Q418.3813,285 417.1781,284.4063 Q416.2094,283.9375 415.5219,282.9219 Q414.85,281.9063 414.85,280.7031 L414.85,279.6094 Q414.85,278.3594 415.4438,277.2656 Q416.0531,276.1719 417.1,275.5938 Q418.1625,275 419.35,275 Q420.0688,275 420.6938,275.25 Q421.3188,275.5 421.85,276 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="44" x="436.15" y="284.4102">Pk1Picc</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="395.5" x2="492.5" y1="295.5" y2="295.5"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="402.5" y="304.918"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="65" x="414.5" y="310.9189">LOG : Logger</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="402.5" y="318.7539"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="73" x="414.5" y="324.7549">pk1Picc : byte[]</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="395.5" x2="492.5" y1="331.1719" y2="331.1719"/><ellipse cx="405.5" cy="343.5898" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="45" x="414.5" y="346.5908">Pk1Picc()</text><ellipse cx="405.5" cy="357.4258" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="60" x="414.5" y="360.4268">getPk1Picc()</text><!--class Pk2Pcd--><rect fill="#FEFECE" filter="url(#f152rugf8lj1r3)" height="172.5234" id="Pk2Pcd" style="stroke: #A80036; stroke-width: 1.5;" width="194" x="62" y="586"/><ellipse cx="133.75" cy="602" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M135.75,598.5 Q135.9531,598 136.1875,597.75 Q136.4219,597.5 136.6875,597.5 Q137.1563,597.5 137.4531,597.7813 Q137.75,598.0625 137.75,598.7188 L137.75,600.2813 Q137.75,600.9375 137.4688,601.2188 Q137.1875,601.5 136.75,601.5 Q136.3594,601.5 136.1094,601.3281 Q135.8594,601.1563 135.75,600.7031 Q135.7031,600.3906 135.5313,600.2188 Q135.2188,599.8906 134.6563,599.7031 Q134.0938,599.5 133.5313,599.5 Q132.8281,599.5 132.2344,599.7813 Q131.6563,600.0625 131.2031,600.6875 Q130.75,601.3125 130.75,602.1719 L130.75,603.0938 Q130.75,604.125 131.5938,604.8125 Q132.4375,605.5 133.9375,605.5 Q134.8281,605.5 135.4531,605.2969 Q135.8125,605.1875 136.2188,604.8281 Q136.4844,604.625 136.625,604.5625 Q136.7656,604.5 136.9375,604.5 Q137.2656,604.5 137.5,604.7656 Q137.75,605.0156 137.75,605.375 Q137.75,605.7188 137.4063,606.125 Q136.9063,606.7188 136.1094,607.0469 Q135.0625,607.5 133.7813,607.5 Q132.2813,607.5 131.0781,606.9063 Q130.1094,606.4375 129.4219,605.4219 Q128.75,604.4063 128.75,603.2031 L128.75,602.1094 Q128.75,600.8594 129.3438,599.7656 Q129.9531,598.6719 131,598.0938 Q132.0625,597.5 133.25,597.5 Q133.9688,597.5 134.5938,597.75 Q135.2188,598 135.75,598.5 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="42" x="154.25" y="606.9102">Pk2Pcd</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="63" x2="255" y1="618" y2="618"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70" y="627.418"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="93" x="82" y="633.4189">BYTE_LENGTH : int</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70" y="641.2539"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="79" x="82" y="647.2549">curve : ECCurve</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70" y="655.0898"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="83" x="82" y="661.0908">pointGS : ECPoint</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70" y="668.9258"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="168" x="82" y="674.9268">randomGenerator : SecureRandom</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70" y="682.7617"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="100" x="82" y="688.7627">pcdSkX2 : BigInteger</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="63" x2="255" y1="695.1797" y2="695.1797"/><ellipse cx="73" cy="707.5977" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="43" x="82" y="710.5986">Pk2Pcd()</text><ellipse cx="73" cy="721.4336" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="58" x="82" y="724.4346">getPk2Pcd()</text><polygon fill="#4177AF" points="73,731.2695,69,737.2695,77,737.2695" style="stroke: #1963A0; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="52" x="82" y="738.2705">getCurve()</text><polygon fill="#4177AF" points="73,745.1055,69,751.1055,77,751.1055" style="stroke: #1963A0; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="66" x="82" y="752.1064">getPcdSkX2()</text><!--class Pk2Picc--><rect fill="#FEFECE" filter="url(#f152rugf8lj1r3)" height="103.3438" id="Pk2Picc" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="260.5" y="263.5"/><ellipse cx="285.85" cy="279.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M287.85,276 Q288.0531,275.5 288.2875,275.25 Q288.5219,275 288.7875,275 Q289.2563,275 289.5531,275.2813 Q289.85,275.5625 289.85,276.2188 L289.85,277.7813 Q289.85,278.4375 289.5688,278.7188 Q289.2875,279 288.85,279 Q288.4594,279 288.2094,278.8281 Q287.9594,278.6563 287.85,278.2031 Q287.8031,277.8906 287.6313,277.7188 Q287.3188,277.3906 286.7563,277.2031 Q286.1938,277 285.6313,277 Q284.9281,277 284.3344,277.2813 Q283.7563,277.5625 283.3031,278.1875 Q282.85,278.8125 282.85,279.6719 L282.85,280.5938 Q282.85,281.625 283.6938,282.3125 Q284.5375,283 286.0375,283 Q286.9281,283 287.5531,282.7969 Q287.9125,282.6875 288.3188,282.3281 Q288.5844,282.125 288.725,282.0625 Q288.8656,282 289.0375,282 Q289.3656,282 289.6,282.2656 Q289.85,282.5156 289.85,282.875 Q289.85,283.2188 289.5063,283.625 Q289.0063,284.2188 288.2094,284.5469 Q287.1625,285 285.8813,285 Q284.3813,285 283.1781,284.4063 Q282.2094,283.9375 281.5219,282.9219 Q280.85,281.9063 280.85,280.7031 L280.85,279.6094 Q280.85,278.3594 281.4438,277.2656 Q282.0531,276.1719 283.1,275.5938 Q284.1625,275 285.35,275 Q286.0688,275 286.6938,275.25 Q287.3188,275.5 287.85,276 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="44" x="302.15" y="284.4102">Pk2Picc</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="261.5" x2="358.5" y1="295.5" y2="295.5"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="268.5" y="304.918"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="65" x="280.5" y="310.9189">LOG : Logger</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="268.5" y="318.7539"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="73" x="280.5" y="324.7549">pk2Picc : byte[]</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="261.5" x2="358.5" y1="331.1719" y2="331.1719"/><ellipse cx="271.5" cy="343.5898" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="45" x="280.5" y="346.5908">Pk2Picc()</text><ellipse cx="271.5" cy="357.4258" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="60" x="280.5" y="360.4268">getPk2Picc()</text><!--link KeyDerivationFunction to Mode--><path d="M292,1007.186 C292,1022.907 292,1038.41 292,1051.953 " fill="none" id="KeyDerivationFunction-Mode" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="292" cy="1000.102" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="292" x2="292" y1="1008.102" y2="992.102"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="284" x2="300" y1="1000.102" y2="1000.102"/><!--link MacPcd to KeyDerivationFunction--><path d="M225.533,489.761 C231.412,502.04 237.277,514.216 243,526 C256.024,552.819 265.289,557.2 273,586 C293.032,660.815 296.85,748.916 296.19,813.472 " fill="none" id="MacPcd-KeyDerivationFunction" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="296.124,818.86,300.2343,809.9098,296.1854,813.8604,292.2349,809.8115,296.124,818.86" style="stroke: #A80036; stroke-width: 1.0;"/><!--link MacPcd to Utilities--><path d="M225.771,511.797 C231.163,516.948 236.899,521.712 243,526 C358.059,606.865 741.952,534.969 873,586 C892.231,593.489 910.993,605.251 927.528,617.682 " fill="none" id="MacPcd-Utilities" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="931.682,620.854,926.9593,612.2113,927.7091,617.8182,922.1021,618.568,931.682,620.854" style="stroke: #A80036; stroke-width: 1.0;"/><!--link MacPcd to Pk2Pcd--><path d="M152.866,526.135 C153.664,545.046 154.441,563.451 155.158,580.454 " fill="none" id="MacPcd-Pk2Pcd" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="155.379,585.685,158.9949,576.5239,155.1676,580.6895,151.002,576.8622,155.379,585.685" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Pk1Pcd to KeyDerivationFunction--><path d="M857.279,361.954 C938.933,406.487 1050.02,482.486 1100,586 C1138.07,664.846 1157.12,716.645 1100,783 C1007.39,890.574 565.79,904.209 377.435,905.036 " fill="none" id="Pk1Pcd-KeyDerivationFunction" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="372.211,905.056,381.2258,909.0225,377.211,905.0374,381.1961,901.0226,372.211,905.056" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Pk2Pcd to KeyDerivationFunction--><path d="M208.335,759.188 C218.694,777.18 229.65,796.207 240.099,814.357 " fill="none" id="Pk2Pcd-KeyDerivationFunction" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="242.744,818.951,241.718,809.1557,240.2484,814.6183,234.7858,813.1487,242.744,818.951" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Pk1Picc to Utilities--><path d="M445.789,366.914 C450.372,415.274 465.124,486.32 511,526 C634.346,632.687 723.173,521.593 873,586 C891.544,593.971 909.808,605.616 926.067,617.759 " fill="none" id="Pk1Picc-Utilities" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="930.157,620.856,925.3959,612.2344,926.1706,617.838,920.567,618.6127,930.157,620.856" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Pk2Picc to Utilities--><path d="M311.375,366.895 C315.626,415.598 330.117,487.213 377,526 C548.091,667.544 667.125,502.8 873,586 C892.029,593.69 910.657,605.449 927.124,617.807 " fill="none" id="Pk2Picc-Utilities" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="931.263,620.96,926.528,612.324,927.2857,617.9299,921.6799,618.6876,931.263,620.96" style="stroke: #A80036; stroke-width: 1.0;"/><!--link NonceZ to Utilities--><path d="M580.714,366.909 C586.008,414.57 601.297,484.492 645,526 C720.977,598.16 778.764,540.184 873,586 C890.643,594.578 908.258,606.107 924.152,617.918 " fill="none" id="NonceZ-Utilities" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="928.155,620.925,923.3604,612.322,924.1569,617.9225,918.5564,618.719,928.155,620.925" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml

  package de.gematik.ti.healthcardaccess.security {
    package de.gematik.ti.healthcardaccess.security.keyentities {
      class MacPcd {
          {static} - LOG : Logger
          {static} - MAX : int
          {static} - TAG_6 : int
          {static} - TAG_49 : int
          - macPcd : byte[]
          - sharedSecretKBytes : byte[]
          - keyP : KeyParameter
          - mac : Mac
          - authTokenY : byte[]
          - authTokenX : byte[]
          - kEnc : byte[]
          - kMac : byte[]
          - protocolID : String
          - curve : ECCurve
          - pk2Picc : byte[]
          - pcdSkX2 : BigInteger
          - macPicc2 : byte[]
          - pk1Picc : byte[]
          + MacPcd()
          - generateMacPcdPicc2()
          - generateAuthToken()
          - generateSharedSecretK()
          - createAsn1AuthToken()
          + getMacPcd()
          + getKEnc()
          + getMacPicc2()
          + getKMac()
      }
    }
  }


  package de.gematik.ti.healthcardaccess.security {
    package de.gematik.ti.healthcardaccess.security.keyentities {
      class NonceZ {
          {static} - LOG : Logger
          - nonceZ : byte[]
          + NonceZ()
          + getNonceZ()
      }
    }
  }


  package de.gematik.ti.healthcardaccess.security {
    package de.gematik.ti.healthcardaccess.security.keyentities {
      class Pk1Pcd {
          {static} - AES_BLOCK_SIZE : int
          {static} - BYTE_LENGTH : int
          - nonceSInt : BigInteger
          - curve : Fp
          - ecPointG : ECPoint
          - randomGenerator : SecureRandom
          - pcdSkX1 : BigInteger
          + Pk1Pcd()
          + getPk1Pcd()
          ~ getNonceSInt()
          ~ getCurve()
          ~ getEcPointG()
          ~ getPcdSkX1()
          ~ getRandomGenerator()
      }
    }
  }


  package de.gematik.ti.healthcardaccess.security {
    package de.gematik.ti.healthcardaccess.security.keyentities {
      class Pk1Picc {
          {static} - LOG : Logger
          - pk1Picc : byte[]
          + Pk1Picc()
          + getPk1Picc()
      }
    }
  }


  package de.gematik.ti.healthcardaccess.security {
    package de.gematik.ti.healthcardaccess.security.keyentities {
      class Pk2Pcd {
          {static} - BYTE_LENGTH : int
          - curve : ECCurve
          - pointGS : ECPoint
          - randomGenerator : SecureRandom
          - pcdSkX2 : BigInteger
          + Pk2Pcd()
          + getPk2Pcd()
          ~ getCurve()
          ~ getPcdSkX2()
      }
    }
  }


  package de.gematik.ti.healthcardaccess.security {
    package de.gematik.ti.healthcardaccess.security.keyentities {
      class Pk2Picc {
          {static} - LOG : Logger
          - pk2Picc : byte[]
          + Pk2Picc()
          + getPk2Picc()
      }
    }
  }


      package de.gematik.ti.healthcardaccess.security {
        class KeyDerivationFunction {
            {static} - CHECKSUMLENGTH : int
            {static} - AES128LENGTH : int
            {static} - OFFSETLENGTH : int
            {static} - ENCLASTBYTE : int
            {static} - MACLASTBYTE : int
            {static} - PASSWORDLASTBYTE : int
            - KeyDerivationFunction()
            {static} + getAES128Key()
            {static} - replaceLastKeyByte()
        }
      }


      package de.gematik.ti.healthcardaccess.security {
        enum Mode {
          ENC
          MAC
          PASSWORD
        }
      }


      package de.gematik.ti.healthcardaccess.security {
        class Utilities {
            {static} - UNCOMPRESSEDPOINTVALUE : int
            - Utilities()
            {static} + byteArrayToECPoint()
            {static} + getKeyObjectEncoded()
        }
      }


    KeyDerivationFunction +-down- Mode
    MacPcd ..>KeyDerivationFunction
    MacPcd ..>Utilities
    MacPcd ..>Pk2Pcd
    Pk1Pcd ..>KeyDerivationFunction
    Pk2Pcd ..>KeyDerivationFunction
    Pk1Picc ..>Utilities
    Pk2Picc ..>Utilities
    NonceZ ..>Utilities




@enduml

PlantUML version 1.2019.06(Fri May 24 19:10:25 CEST 2019)
(APACHE source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.4+10-b304.69
Operating System: Windows 7
OS Version: 6.1
Default Encoding: Cp1252
Language: de
Country: DE
--></g></svg>